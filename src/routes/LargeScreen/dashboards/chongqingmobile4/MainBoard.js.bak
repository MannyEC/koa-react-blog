import React from 'react';
import PropTypes from 'prop-types';
import ReactGridLayout from 'react-grid-layout';
import CoreLayout from 'layouts/LargeScreenLayout/CoreLayout/CoreLayout';
import EditCover from '../../components/EditCover';
import CqMobileLayout from 'layouts/LargeScreenLayout/CqMobileLayout/CqMobileLayout';
import components from './index';
import bg from './bg.png';

import classes from './MainBoard.scss';

const gridLayoutProps = {
  rowHeight: 47,
  cols: 8,
  width: 1280,
  margin: [20, 10],
  containerPadding: [20, 10],
  layout: [
    {
      i: '1', x: 0, y: 0, w: 8, h: 6
    },
    {
      i: '2', x: 0, y: 6, w: 4, h: 6
    },
    {
      i: '3', x: 5, y: 6, w: 4, h: 6
    },
    {
      i: '4', x: 0, y: 12, w: 8, h: 6
    }
  ],
  isDraggable: false,
  isResizable: false
};

const MainBoard = (props) => {
  const { modules, dashboard, mod } = props;
  const { template: { height, width } } = dashboard;
  return (
    <CoreLayout width={width} height={height} background={bg}>
      <CqMobileLayout title={'防病毒场景态势'}>
              <ReactGridLayout {...gridLayoutProps} >
                {Object.keys(components).map((item, idx) => {
                  const config = modules.find(mod => mod.type === item);
                  const Component = config
                    ? components[item]
                      .find(component => component.type === config.display_type).component
                    : components[item][0].component;
                  return (
                    <div key={`${idx + 1}`}>
                      <EditCover
                        dashboard={dashboard.id}
                        layout={config ? config.id : ''}
                        mode={props.mode}
                      >
                        <Component config={config} />
                      </EditCover>
                    </div>
                  );
                })}
              </ReactGridLayout>
      </CqMobileLayout>
    </CoreLayout>
  );
};

MainBoard.propTypes = {
  dashboard: PropTypes.object,
  modules: PropTypes.array,
  mode: PropTypes.string
};

MainBoard.defaultProps = {
  mode: 'show'
};

export default MainBoard;